

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/zz.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="小周">
  <meta name="keywords" content="">
  
    <meta name="description" content="数据结构  列表与元素  基本差异  列表是动态的，长度大小不固定，可任意删减元素 元组是静态的，长度大小固定，无法增删，只能新建生成   存储差异 12345678910111213141516&gt;&gt;&gt; ls&#x3D;[1,2,3]&gt;&gt;&gt; ls[1, 2, 3]&gt;&gt;&gt; ls.__sizeof__()64&gt;&gt;&gt; tup&#x3D;1,2,">
<meta property="og:type" content="article">
<meta property="og:title" content="Python3.8进阶(一)">
<meta property="og:url" content="https://zhouyinglin.cn/post/pythonjinjie1.html">
<meta property="og:site_name" content="小周的院子">
<meta property="og:description" content="数据结构  列表与元素  基本差异  列表是动态的，长度大小不固定，可任意删减元素 元组是静态的，长度大小固定，无法增删，只能新建生成   存储差异 12345678910111213141516&gt;&gt;&gt; ls&#x3D;[1,2,3]&gt;&gt;&gt; ls[1, 2, 3]&gt;&gt;&gt; ls.__sizeof__()64&gt;&gt;&gt; tup&#x3D;1,2,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static001.geekbang.org/resource/image/94/45/949742df36600c086c31e399ce515f45.png?wh=1698*653">
<meta property="article:published_time" content="2022-11-21T08:47:35.000Z">
<meta property="article:modified_time" content="2022-12-15T02:32:52.000Z">
<meta property="article:author" content="小周">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://static001.geekbang.org/resource/image/94/45/949742df36600c086c31e399ce515f45.png?wh=1698*653">
  
  
  
    <meta name="baidu-site-verification" content="code-bMcoZ9RRBp" />
  
  <title>Python3.8进阶(一) - 小周的院子</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zhouyinglin.cn","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"DOFm5rBfeIBUxN13vhiXlS4S-MdYXbMMI","app_key":"FJKOtk5nWqYzGoXXiFAvHIDC","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>小周的院子</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>
    
    <!-- 添加zyl天气 -->

<div id="tp-weather-widget"></div>
    <script>
        (function (a, h, g, f, e, d, c, b) { b = function () { d = h.createElement(g); c = h.getElementsByTagName(g)[0]; d.src = e; d.charset = "utf-8"; d.async = 1; c.parentNode.insertBefore(d, c) }; a["SeniverseWeatherWidgetObject"] = f; a[f] || (a[f] = function () { (a[f].q = a[f].q || []).push(arguments) }); a[f].l = +new Date(); if (a.attachEvent) { a.attachEvent("onload", b) } else { a.addEventListener("load", b, false) } }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WKJ1F428HH2F",
            geolocation: true,
            language: "zh-Hans",
            unit: "c",
            theme: "auto",
            token: "5089001e-aa9f-41c5-862d-e416aabf81f7",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>



    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                文章
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    归档
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    分类
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    标签
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/boxs/">
                <i class="iconfont icon-switch-fill"></i>
                百宝箱
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html">
                <i class="iconfont icon-rss"></i>
                虫洞
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://blog-cnd-1307088890.cos.ap-guangzhou.myqcloud.com/202212161220542.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Python3.8进阶(一)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-11-21 16:47" pubdate>
          2022年11月21日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          18k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          149 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Python3.8进阶(一)</h1>
            
            
              <div class="markdown-body">
                
                <span id="more"></span>
<!-- categories:Dev、Ops、Study、Sth、News、work-->
<!-- tags: 
Python、MySQL、LeetCode、机器学习、Linux、Big Data、Java、BlockChain、Docker、Web 、分布式、
Maven、数据结构、JVM、JavaScript、Crontab、Shell、Ubuntu、VPN、NodeJS、String、VM、Hadoop、
Life、树莓派、Git、Hexo、算法、运维、网络、看法、电影、美学、写作、哲学、文档、绘画、前端、
历史、政治、社会、导购
 -->
<h2 id="数据结构"><a class="markdownIt-Anchor" href="#数据结构"></a> 数据结构</h2>
<h3 id="列表与元素"><a class="markdownIt-Anchor" href="#列表与元素"></a> 列表与元素</h3>
<h4 id="基本差异"><a class="markdownIt-Anchor" href="#基本差异"></a> 基本差异</h4>
<ul>
<li>列表是动态的，长度大小不固定，可任意删减元素</li>
<li>元组是静态的，长度大小固定，无法增删，只能新建生成</li>
</ul>
<h4 id="存储差异"><a class="markdownIt-Anchor" href="#存储差异"></a> 存储差异</h4>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls</span><br>[1, 2, 3]<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls.__sizeof__()</span><br>64<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">tup=<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">tup.__sizeof__()</span><br>48<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span><br>**********初始空元素的占用情况************<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">l=[]</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">l.__sizeof__()</span><br>40<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">tup=()</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">tup.__sizeof__()</span><br>24<br></code></pre></td></tr></table></figure>
<p>列表与元组相同的3个元素，元组存储空间比列表少了16个字节。这16字节分别代表：</p>
<ol>
<li>指向对应元素的指针。列表是动态的，需要存储指针</li>
<li>额外存储已分配的长度大小，用于追踪列表空间的使用情况，及时分配额外空间</li>
</ol>
<h4 id="列表扩容"><a class="markdownIt-Anchor" href="#列表扩容"></a> 列表扩容</h4>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1=[]</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1.append(<span class="hljs-number">1</span>)</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1.append(<span class="hljs-number">2</span>)</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1.append(<span class="hljs-number">3</span>)</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1</span><br>[1, 2, 3]<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls</span><br>[1, 2, 3]<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls1.__sizeof__()</span><br>72<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">ls.__sizeof__()</span><br>64<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span><br></code></pre></td></tr></table></figure>
<p>ls1初始化为空列表，追加至3个元素，ls初始化就是3个元素。初始化的3元素比追加的3元素小了8个字节。</p>
<ul>
<li>
<p>初始化的占用情况：初始40+元素大小</p>
</li>
<li>
<p>追加的占用情况：初始+扩容大小。每次扩容新增可存储4个元素的空间</p>
</li>
</ul>
<p>列表追加的机制保证了列表的高效性，其增删操作的时间复杂度均为O(1)。如下是完整版本测试：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs stylus">l = <span class="hljs-selector-attr">[]</span><br>l.<span class="hljs-built_in">__sizeof__</span>() <span class="hljs-comment">// 空列表的存储空间为40字节</span><br><span class="hljs-number">40</span><br>l<span class="hljs-selector-class">.append</span>(<span class="hljs-number">1</span>)<br>l.<span class="hljs-built_in">__sizeof__</span>() <br><span class="hljs-number">72</span> <span class="hljs-comment">// 加入了元素1之后，列表为其分配了可以存储4个元素的空间 (72 - 40)/8 = 4</span><br>l<span class="hljs-selector-class">.append</span>(<span class="hljs-number">2</span>) <br>l.<span class="hljs-built_in">__sizeof__</span>()<br><span class="hljs-number">72</span> <span class="hljs-comment">// 由于之前分配了空间，所以加入元素2，列表空间不变</span><br>l<span class="hljs-selector-class">.append</span>(<span class="hljs-number">3</span>)<br>l.<span class="hljs-built_in">__sizeof__</span>() <br><span class="hljs-number">72</span> <span class="hljs-comment">// 同上</span><br>l<span class="hljs-selector-class">.append</span>(<span class="hljs-number">4</span>)<br>l.<span class="hljs-built_in">__sizeof__</span>() <br><span class="hljs-number">72</span> <span class="hljs-comment">// 同上</span><br>l<span class="hljs-selector-class">.append</span>(<span class="hljs-number">5</span>)<br>l.<span class="hljs-built_in">__sizeof__</span>() <br><span class="hljs-number">104</span> <span class="hljs-comment">// 加入元素5之后，列表的空间不足，所以又额外分配了可以存储4个元素的空间</span><br></code></pre></td></tr></table></figure>
<h4 id="列表缩容"><a class="markdownIt-Anchor" href="#列表缩容"></a> 列表缩容</h4>
<p>（确实会缩容）</p>
<p><strong>TODO</strong></p>
<h4 id="性能差异"><a class="markdownIt-Anchor" href="#性能差异"></a> 性能差异</h4>
<p>初始化速度对比</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">0</span>-<span class="hljs-number">7</span>-ubuntu:~$ python3 -m timeit &#x27;x=(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)&#x27;<br><span class="hljs-attribute">100000000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">0</span>.<span class="hljs-number">0113</span> usec per loop<br><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">0</span>-<span class="hljs-number">7</span>-ubuntu:~$ python3 -m timeit &#x27;y=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]&#x27;<br><span class="hljs-attribute">10000000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">0</span>.<span class="hljs-number">0519</span> usec per loop<br><br><span class="hljs-comment"># 代码写法（无法执行多行）：</span><br><span class="hljs-attribute">import</span> timeit<br><span class="hljs-attribute">print</span>(timeit.Timer(&#x27;x=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]&#x27;).timeit())<br></code></pre></td></tr></table></figure>
<p>索引操作对比</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">0</span>-<span class="hljs-number">7</span>-ubuntu:~$ python3 -m timeit -s &#x27;x=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]&#x27; &#x27;y=x[<span class="hljs-number">3</span>]&#x27;<br><span class="hljs-attribute">10000000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">0</span>.<span class="hljs-number">022</span> usec per loop<br><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">0</span>-<span class="hljs-number">7</span>-ubuntu:~$ python3 -m timeit -s &#x27;x=(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)&#x27; &#x27;y=x[<span class="hljs-number">3</span>]&#x27;<br><span class="hljs-attribute">10000000</span> loops, best of <span class="hljs-number">3</span>: <span class="hljs-number">0</span>.<span class="hljs-number">0232</span> usec per loop<br></code></pre></td></tr></table></figure>
<ul>
<li>元组比列表更加轻量级，性能速度略优于列表</li>
<li>列表不被使用时会被回收掉，未被使用且小的元组会被缓存至内存，性能优于列表</li>
</ul>
<h4 id="使用场景对比"><a class="markdownIt-Anchor" href="#使用场景对比"></a> 使用场景对比</h4>
<ul>
<li>存储数据与数量不变，如返回地点经纬度，优先使用元组</li>
<li>存储数据获数量需要变动，如用户查看的帖子，优先使用列表</li>
</ul>
<h3 id="字典与集合"><a class="markdownIt-Anchor" href="#字典与集合"></a> 字典与集合</h3>
<h4 id="基本差异-2"><a class="markdownIt-Anchor" href="#基本差异-2"></a> 基本差异</h4>
<p>字典：键值对格式的元素集合。3.7后的字典有序，便于查、增、删</p>
<p>集合：与字典类似，没有键值对，无序唯一的元素组合，元素类型可不同</p>
<h4 id="基本操作"><a class="markdownIt-Anchor" href="#基本操作"></a> 基本操作</h4>
<p><strong>创建</strong></p>
<p>注意：字典的key只能是不可变的，因此数字、字符串、元组均可作为key，但列表、字典不能作为key，因为是自动的</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># 字典</span><br><span class="hljs-attr">d1</span> = &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;jason&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>: <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;gender&#x27;</span>: <span class="hljs-string">&#x27;male&#x27;</span>&#125;<br><span class="hljs-attr">d2</span> = dict(&#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;jason&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>: <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;gender&#x27;</span>: <span class="hljs-string">&#x27;male&#x27;</span>&#125;)<br><span class="hljs-attr">d3</span> = dict([(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;jason&#x27;</span>), (<span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-number">20</span>), (<span class="hljs-string">&#x27;gender&#x27;</span>, <span class="hljs-string">&#x27;male&#x27;</span>)])<br><span class="hljs-attr">d4</span> = dict(name=<span class="hljs-string">&#x27;jason&#x27;</span>, age=<span class="hljs-number">20</span>, gender=<span class="hljs-string">&#x27;male&#x27;</span>) <br><span class="hljs-comment"># 集合</span><br><span class="hljs-attr">s1</span> = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br><span class="hljs-attr">s2</span> = set([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br></code></pre></td></tr></table></figure>
<p><strong>获取</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># 字典</span><br><span class="hljs-built_in">print</span>(dic[key])<br><span class="hljs-built_in">print</span>(dic.<span class="hljs-built_in">get</span>(key))<br><span class="hljs-comment"># 集合：不允许索引访问，只允许查询是否存在(字典也可以)</span><br><span class="hljs-built_in">print</span>(v <span class="hljs-keyword">in</span> s)<br></code></pre></td></tr></table></figure>
<p><strong>删除</strong></p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-comment"># 字典</span><br>dic.<span class="hljs-keyword">pop</span>(key)<br>dic.<span class="hljs-keyword">pop</span>() <span class="hljs-comment"># 删除末尾元素</span><br><span class="hljs-comment"># 集合</span><br>s.remove(v)<br>s.<span class="hljs-keyword">pop</span>() <span class="hljs-comment"># 谨慎操作，集合无序</span><br></code></pre></td></tr></table></figure>
<p><strong>排序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 字典</span><br><span class="hljs-built_in">sorted</span>(d.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">0</span>]) <span class="hljs-comment"># 按key</span><br><span class="hljs-built_in">sorted</span>(d.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>]) <span class="hljs-comment"># 按value</span><br><span class="hljs-comment"># 集合（返回的是列表）</span><br><span class="hljs-built_in">sorted</span>(s)<br></code></pre></td></tr></table></figure>
<h4 id="列表与集合性能比较"><a class="markdownIt-Anchor" href="#列表与集合性能比较"></a> 列表与集合性能比较</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-built_in">id</span> = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10000</span>)]<br>price = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20000</span>, <span class="hljs-number">30000</span>)]<br>products = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(<span class="hljs-built_in">id</span>, price))<br><br><span class="hljs-comment"># list</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_unique_price_using_list</span>(<span class="hljs-params">products</span>):<br>    unique_price_list = []<br>    <span class="hljs-keyword">for</span> _, price <span class="hljs-keyword">in</span> products:  <span class="hljs-comment"># A</span><br>        <span class="hljs-keyword">if</span> price <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> unique_price_list:  <span class="hljs-comment"># B</span><br>            unique_price_list.append(price)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(unique_price_list)<br><br><span class="hljs-comment"># set</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_unique_price_using_set</span>(<span class="hljs-params">products</span>):<br>    unique_price_set = <span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">for</span> _, price <span class="hljs-keyword">in</span> products:<br>        unique_price_set.add(price)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(unique_price_set)<br><br><span class="hljs-comment"># 分别计算运行时间</span><br>start_list = time.time()<br><span class="hljs-comment"># find_unique_price_using_list(products)</span><br>find_unique_price_using_set(products)<br>end_list = time.time()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;用时：&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(end_list-start_list))<br><br>输出(相差<span class="hljs-number">500</span>倍)：<br><span class="hljs-built_in">list</span>用时：<span class="hljs-number">0.5515346527099609</span><br><span class="hljs-built_in">set</span> 用时：<span class="hljs-number">0.0009975433349609375</span><br></code></pre></td></tr></table></figure>
<h4 id="字典与集合原理"><a class="markdownIt-Anchor" href="#字典与集合原理"></a> 字典与集合原理</h4>
<p>同一性：二者均由哈希表实现</p>
<p>差异性：</p>
<ul>
<li>字典存储哈希值、key、value 3种元素</li>
<li>集合只存哈希和元素</li>
</ul>
<p><strong>新增原理</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># 字典新增</span><br>dic = &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;mike&#x27;</span>&#125;<br>dic[<span class="hljs-string">&#x27;age&#x27;</span>]=18<br><span class="hljs-comment"># 集合新增</span><br>s = &#123;<span class="hljs-string">&#x27;a&#x27;</span>&#125;<br>s.<span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;b&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>向字典/集合（统称为哈希表）插入元素时，先计算出键的哈希值<code>hash(key)</code>，再和<code>mask = PyDicMinSize - 1 </code>做与操作，计算出插入的位置：<code>index = hash(key) &amp; mask</code>，计算位置后查看该位置是否为空：</p>
<ul>
<li>
<p>若该位置为空则插入</p>
</li>
<li>
<p>若该位置已占用则比较哈希值和键是否相等：</p>
<ul>
<li>
<p>若hash值和key均相等，则该元素已存在，如果值不同则替换</p>
</li>
<li>
<p>若hash值或key有一个不相等，就是哈希冲突，Python将顺位插入其他位置</p>
</li>
</ul>
</li>
</ul>
<p>哈希冲突会降低字典/集合操作的速度，因此哈希表内一般保留了1/3剩余空间，元素插入时剩余空间小于1/3时就会进行扩容，扩容时表内所有元素会被重新排放。</p>
<hr>
<p><strong>思考</strong></p>
<ol>
<li>
<p>在字典查找过程中，计算出的key的哈希值与已存在的hash值相等，但key值不相等？</p>
<p>解决：不同的key计算出来的hash相同，属于哈希冲突，在插入阶段就已经避免了这种错误</p>
</li>
<li>
<p>列表的可变和不可变问题。列表是内容可变，但它本身的地址是不变的，为什么不能用来当做字典的key，这里面是否混淆了什么？</p>
</li>
</ol>
<p>（TODO）</p>
<h3 id="字符串"><a class="markdownIt-Anchor" href="#字符串"></a> 字符串</h3>
<p>这段没什么说的，简单带过。<a href="https://zhouyinglin.cn/post/python3sutong.html">速通篇</a>也有简单介绍。</p>
<p><strong>定义</strong></p>
<p>前两者为了方便区分内容中的引号，第三种方便多行内容</p>
<ul>
<li>‘xxx’</li>
<li>“xxx”</li>
<li>“”“xxx”“”</li>
</ul>
<p><strong>转义</strong></p>
<table>
<thead>
<tr>
<th>转义字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>表示单引号\</td>
</tr>
<tr>
<td>\n</td>
<td>表示换行</td>
</tr>
<tr>
<td><code>\&quot;</code></td>
<td>表示双引号 &quot;</td>
</tr>
</tbody>
</table>
<p>字符串属于不可变序列，除了拼接方式以外，没有修改字符的方法。一般情况修改都是通过字符串切片或扫描原字符串，修改后放入新字符串。</p>
<p><strong>+=拼接</strong></p>
<p>当s1+=s2拼接字符串时，首先检测s1是否有其他引用，若没有则原地扩充字符串buffer大小，此方法时间复杂度为O(n),效率不算太低。</p>
<p><strong>string.join拼接</strong></p>
<p>将每个元素按照指定格式连接起来。如下，循环结束后列表中的元素为0~99999，通过空格连接所有元素，并赋值给 <code>l</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">l = <span class="hljs-selector-attr">[]</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100000</span>):<br>    l<span class="hljs-selector-class">.append</span>(<span class="hljs-built_in">str</span>(n))<br>l = <span class="hljs-string">&#x27; &#x27;</span><span class="hljs-selector-class">.join</span>(l) <br></code></pre></td></tr></table></figure>
<p><strong>其他操作函数</strong></p>
<p>分割：string.split()常用于路径、链接等切割子串的场景</p>
<p>去首尾：string.strip(str)</p>
<h3 id="io流相关"><a class="markdownIt-Anchor" href="#io流相关"></a> IO流相关</h3>
<p>此处没什么说的，速通篇的文件操作内容基本都有。比较常用的应该是Json相关的一些函数，这里再次重申一遍。</p>
<p><strong>dump、load和dumps、loads</strong></p>
<ul>
<li>dump、load
<ul>
<li>dump用于将一个对象存储至本地文件</li>
<li>load用于从本地文件中读取内容字符串并转为对象</li>
</ul>
</li>
<li>dumps、loads
<ul>
<li>dumps用于将一个对象转为字符串</li>
<li>loads用于将字符串转回对象</li>
</ul>
</li>
</ul>
<p>注意，在实际环境中，IO的应用场景较多适用于文件读写、网络、其他进程等方面。如下使用NLP分析文本的任务用到了多方面的东西。</p>
<p>文本 in.txt 内容</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs applescript">I have a dream <span class="hljs-keyword">that</span> <span class="hljs-keyword">my</span> four little children will one <span class="hljs-built_in">day</span> live <span class="hljs-keyword">in</span> a nation <span class="hljs-keyword">where</span> they will <span class="hljs-keyword">not</span> be judged <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> color <span class="hljs-keyword">of</span> their skin <span class="hljs-keyword">but</span> <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> content <span class="hljs-keyword">of</span> their <span class="hljs-built_in">character</span>. I have a dream today.<br><br>I have a dream <span class="hljs-keyword">that</span> one <span class="hljs-built_in">day</span> down <span class="hljs-keyword">in</span> Alabama, <span class="hljs-keyword">with</span> <span class="hljs-keyword">its</span> vicious racists, . . . one <span class="hljs-built_in">day</span> right there <span class="hljs-keyword">in</span> Alabama little black boys <span class="hljs-keyword">and</span> black girls will be able <span class="hljs-keyword">to</span> join hands <span class="hljs-keyword">with</span> little white boys <span class="hljs-keyword">and</span> white girls <span class="hljs-keyword">as</span> sisters <span class="hljs-keyword">and</span> brothers. I have a dream today.<br><br>I have a dream <span class="hljs-keyword">that</span> one <span class="hljs-built_in">day</span> <span class="hljs-keyword">every</span> valley shall be exalted, <span class="hljs-keyword">every</span> hill <span class="hljs-keyword">and</span> mountain shall be made low, <span class="hljs-keyword">the</span> rough places will be made plain, <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> crooked places will be made straight, <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> glory <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> Lord shall be revealed, <span class="hljs-keyword">and</span> all flesh shall see <span class="hljs-keyword">it</span> together.<br><br>This <span class="hljs-keyword">is</span> our hope. . . With this faith we will be able <span class="hljs-keyword">to</span> hew <span class="hljs-keyword">out of</span> <span class="hljs-keyword">the</span> mountain <span class="hljs-keyword">of</span> despair a stone <span class="hljs-keyword">of</span> hope. With this faith we will be able <span class="hljs-keyword">to</span> transform <span class="hljs-keyword">the</span> jangling discords <span class="hljs-keyword">of</span> our nation <span class="hljs-keyword">into</span> a beautiful symphony <span class="hljs-keyword">of</span> brotherhood. With this faith we will be able <span class="hljs-keyword">to</span> work together, <span class="hljs-keyword">to</span> pray together, <span class="hljs-keyword">to</span> struggle together, <span class="hljs-keyword">to</span> go <span class="hljs-keyword">to</span> jail together, <span class="hljs-keyword">to</span> stand up <span class="hljs-keyword">for</span> freedom together, knowing <span class="hljs-keyword">that</span> we will be free one <span class="hljs-built_in">day</span>. . . .<br><br>And when this happens, <span class="hljs-keyword">and</span> when we allow freedom ring, when we let <span class="hljs-keyword">it</span> ring <span class="hljs-keyword">from</span> <span class="hljs-keyword">every</span> village <span class="hljs-keyword">and</span> <span class="hljs-keyword">every</span> hamlet, <span class="hljs-keyword">from</span> <span class="hljs-keyword">every</span> state <span class="hljs-keyword">and</span> <span class="hljs-keyword">every</span> city, we will be able <span class="hljs-keyword">to</span> speed up <span class="hljs-keyword">that</span> <span class="hljs-built_in">day</span> when all <span class="hljs-keyword">of</span> God&#x27;s children, black men <span class="hljs-keyword">and</span> white men, Jews <span class="hljs-keyword">and</span> Gentiles, Protestants <span class="hljs-keyword">and</span> Catholics, will be able <span class="hljs-keyword">to</span> join hands <span class="hljs-keyword">and</span> sing <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">words</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> old Negro spiritual: <span class="hljs-string">&quot;Free at last! Free at last! Thank God Almighty, we are free at last!&quot;</span><br></code></pre></td></tr></table></figure>
<p>文本分析：该文本包含多段，每段包含大小写字母、标点符号、空格、换行等</p>
<p>任务：计算该文本中每个单词出现的频次，按频次高低排列出来并输出到 out.txt</p>
<p><strong>处理代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-comment"># 过滤内容，只保留字母、数字下划线，取出标点符号</span><br>    text = re.sub(<span class="hljs-string">r&quot;[^\w]&quot;</span>, <span class="hljs-string">&quot; &quot;</span>, text)<br>    <span class="hljs-comment"># 转小写并按空白字符切分字符串为列表</span><br>    text = text.lower().split(<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-comment"># 过滤列表中的空白元素</span><br>    text_list = <span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> text: text != <span class="hljs-string">&#x27;&#x27;</span>, text)<br>    <span class="hljs-comment"># 新建空字典</span><br>    word_cnt = &#123;&#125;<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> text_list:<br>        <span class="hljs-comment"># 计算词频,如果这个词不在字典，那么新增该键值对并初始化数量为1，</span><br>        <span class="hljs-comment"># 如果在字典，则次数+1</span><br>        <span class="hljs-keyword">if</span> word <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> word_cnt:<br>            <span class="hljs-comment"># 为字典新增元素</span><br>            word_cnt[word] = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># 为已存在的元素增加频次</span><br>        word_cnt[word] += <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># 根据词频排序字典</span><br>    sorted_dic = <span class="hljs-built_in">sorted</span>(word_cnt.items(), key=<span class="hljs-keyword">lambda</span> kv: kv[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">return</span> sorted_dic<br><br><span class="hljs-comment"># 读取文本</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;in.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    context = f.read()<br><br><span class="hljs-comment"># 将读取到的文本传入解析函数，得到解析后的结果</span><br>word_cnt = parse(context)<br><br><span class="hljs-comment"># 将解析后的结果写入out.txt</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> word, cnt <span class="hljs-keyword">in</span> word_cnt:<br>        f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;word&#125;</span> <span class="hljs-subst">&#123;cnt&#125;</span>\n&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>注意，这里的 parse 函数课分析任意文本数据，但如果文件过大可能会造成内存崩溃。通过给read指定 size 参数或者通过 readline() 来读取少部分文本，减轻内存压力</p>
<p>该代码用到的一些知识点：</p>
<ul>
<li><code>re.sub(r&quot;[^\w]&quot;, &quot; &quot;, text)</code>：提取所需文本</li>
</ul>
<p>**（TODO）**这里有个问题：为什么正则用的是\w，匹配所有字母数字下划线，替换成空格。那不是代表匹配到的这些字母数字下划线将替换成空格吗？但替换的结果却是将符号替换成了空格，这不是反了吗？</p>
<p><strong>操作IO应该注意的点</strong></p>
<ol>
<li>应进行充分的错误处理，细心编码防止出现漏洞</li>
<li>对内存、磁盘占用有充分估计</li>
<li>代码简介清晰，充分利用JSON序列化</li>
</ol>
<h2 id="条件分支与循环"><a class="markdownIt-Anchor" href="#条件分支与循环"></a> 条件分支与循环</h2>
<h3 id="分支"><a class="markdownIt-Anchor" href="#分支"></a> 分支</h3>
<p><code>if</code>语句可单独使用，但<code>elif</code>、<code>else</code>必须配合<code>if</code>使用。</p>
<p><strong>if省略判断语句的写法</strong>、</p>
<p>除了boolean外，不建议写成省略方式</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">if s:</span> <span class="hljs-comment">#s是一个字符串</span><br>    <span class="hljs-string">……</span><br><span class="hljs-attr">if l:</span> <span class="hljs-comment"># l 是一个列表</span><br>    <span class="hljs-string">……</span><br></code></pre></td></tr></table></figure>
<p><img src="https://static001.geekbang.org/resource/image/94/45/949742df36600c086c31e399ce515f45.png?wh=1698*653" srcset="/img/loading.gif" lazyload alt></p>
<h3 id="循环"><a class="markdownIt-Anchor" href="#循环"></a> 循环</h3>
<p>只要对象的数据结构是可迭代的，均可以使用<code>for item in &lt;iterable&gt;: ……</code>的方式遍历序列中的所有元素。如需在遍历时获取当前循环的索引，可使用内置<code>enumerate()</code>	函数遍历集合，这个函数返回序列的值和对应的索引</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs axapta">l = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]<br><span class="hljs-keyword">for</span> <span class="hljs-keyword">index</span>, item <span class="hljs-keyword">in</span> enumerate(l):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">index</span> &lt; <span class="hljs-number">5</span>:<br>        <span class="hljs-keyword">print</span>(item)<br></code></pre></td></tr></table></figure>
<p>关于for循环与while循环的选用：</p>
<ul>
<li>
<p>遍历已知序列寻找元素进行某些操作，使用for循环</p>
</li>
<li>
<p>需要满足某条件前重复执行某些操作，使用while循环</p>
</li>
</ul>
<p>（在效率上，for循环可能更优于while循环）</p>
<h3 id="分支与循环复用"><a class="markdownIt-Anchor" href="#分支与循环复用"></a> 分支与循环复用</h3>
<p>很多人写for循环都爱这样写，在没学会之前看这种复用代码是很头疼的，全靠猜。但写的人会觉得很简洁，一行代码搞定，效率upup。如下是一些常见的复用情况</p>
<p><strong>if、for复用</strong></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># 格式</span><br>expression <span class="hljs-keyword">for</span> <span class="hljs-keyword">item</span> <span class="hljs-keyword">in</span> iterable <span class="hljs-keyword">if</span> condition<br><br><span class="hljs-comment"># 等同于如下</span><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">item</span> <span class="hljs-keyword">in</span> iterable:<br>    <span class="hljs-keyword">if</span> condetion:<br>        expression<br><br><span class="hljs-comment"># 例如：循环对text每一行进行去空格、按逗号切分，且过滤小于3个长度的单词</span><br>s.strip() <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> <span class="hljs-keyword">text</span>.<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s.strip()) &gt; <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p><strong>if、else、for复用</strong></p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-comment"># 格式</span><br>expression1 <span class="hljs-keyword">if</span> condition <span class="hljs-keyword">else</span> expression2 <span class="hljs-keyword">for</span> <span class="hljs-built_in">item</span> <span class="hljs-keyword">in</span> iterable<br><br><span class="hljs-comment"># 等同于如下：</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">item</span> <span class="hljs-keyword">in</span> iterable:<br>    <span class="hljs-keyword">if</span> condition:<br>        expression1<br>    <span class="hljs-keyword">else</span>:<br>        expression2<br></code></pre></td></tr></table></figure>
<p><strong>if 、for双循环</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># 格式</span><br>expression1 <span class="hljs-keyword">for</span> item1 in <span class="hljs-keyword">iterable</span> <span class="hljs-keyword">for</span> item2 in <span class="hljs-keyword">iterable</span> <span class="hljs-keyword">if</span> condition<br><br><span class="hljs-comment"># 例如：两个列表x、y，返回各自列表中所有元素组成的元祖</span><br>(xx,yy) <span class="hljs-keyword">for</span> xx in x <span class="hljs-keyword">for</span> yy in y <span class="hljs-keyword">if</span> xx != yy<br></code></pre></td></tr></table></figure>
<p>举例：将下列属性分别压成一个装了3个字典的列表</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">attributes</span> = [<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;dob&#x27;</span>, <span class="hljs-string">&#x27;gender&#x27;</span>]<br><span class="hljs-attr">values</span> = [[<span class="hljs-string">&#x27;jason&#x27;</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>, <span class="hljs-string">&#x27;male&#x27;</span>],<br>          [<span class="hljs-string">&#x27;mike&#x27;</span>, <span class="hljs-string">&#x27;1999-01-01&#x27;</span>, <span class="hljs-string">&#x27;male&#x27;</span>],<br>          [<span class="hljs-string">&#x27;nancy&#x27;</span>, <span class="hljs-string">&#x27;2001-02-01&#x27;</span>, <span class="hljs-string">&#x27;female&#x27;</span>]]<br><span class="hljs-attr">list</span> = [dict(zip(attributes, value)) for value in values]<br></code></pre></td></tr></table></figure>
<h2 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h2>
<p>关于函数定义</p>
<p>def 是可执行语句，函数在调用前是不存在的。因此在调用时需要确保所需函数已经定义过。</p>
<p>关于传参</p>
<ul>
<li>参数可设默认，调用时没传时使用默认，传了就用传入的</li>
<li>参数可以是任意类型，只要符合代码、语法规则即可（多态）。使用时可以再函数开头添加数据类型检查</li>
</ul>
<h3 id="嵌套函数"><a class="markdownIt-Anchor" href="#嵌套函数"></a> 嵌套函数</h3>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">f1</span>():</span><br><span class="hljs-function">    <span class="hljs-title">print</span>(<span class="hljs-string">&#x27;hello&#x27;</span>)</span><br>    <span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">f2</span>():</span><br><span class="hljs-function">        <span class="hljs-title">print</span>(<span class="hljs-string">&#x27;world&#x27;</span>)</span><br>    <span class="hljs-function"><span class="hljs-title">f2</span>()</span><br><span class="hljs-function"><span class="hljs-title">f1</span>()</span><br></code></pre></td></tr></table></figure>
<p><strong>嵌套的优点</strong></p>
<ul>
<li>保护内部函数隐私，不会暴露在全局作用域，如函数内部有隐私数据等情况，就可以使用嵌套，外部无法单独调用到它的内部函数</li>
<li>合理的嵌套有利于提高代码运行效率，当内部函数需递归或多次运行时，只需运行一次的外部函数可以执行某些不必要的其他操作。如下：</li>
</ul>
<p>递归计算阶乘，执行循环计算的主体是内部函数，外层函数用于检测输入合法性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">factorial</span>(<span class="hljs-params"><span class="hljs-built_in">input</span></span>):<br>    <span class="hljs-comment"># validation check</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(<span class="hljs-built_in">input</span>, <span class="hljs-built_in">int</span>):<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;input must be an integer.&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">input</span> &lt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;input must be greater or equal to 0&#x27;</span> )<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_factorial</span>(<span class="hljs-params"><span class="hljs-built_in">input</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">input</span> &lt;= <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">input</span> * inner_factorial(<span class="hljs-built_in">input</span>-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> inner_factorial(<span class="hljs-built_in">input</span>)<br><br><span class="hljs-built_in">print</span>(factorial(<span class="hljs-number">5</span>))<br></code></pre></td></tr></table></figure>
<h3 id="函数变量作用域"><a class="markdownIt-Anchor" href="#函数变量作用域"></a> 函数变量作用域</h3>
<ul>
<li>全局变量：定义在整个文件层次上，任意地方均可访问</li>
<li>局部变量：只在函数内部有效，函数执行完毕后变量被回收。</li>
<li>如局部变量与全局变量同名，则局部变量生效</li>
</ul>
<p><strong>注意</strong></p>
<p>不能再函数内部随意改变全局变量的值，Python解释器默认函数内部的变量为局部变量，又发现它在内部并未声明，就无法操作变量。</p>
<p><strong>变量的二次声明</strong></p>
<ul>
<li>如需在函数内部修改全局变量的值，在函数内部使用<code>global</code>重新声明该变量</li>
<li>如需在嵌套函数的内部函数中修改外部函数定义的变量，则需要在内部函数内部使用<code>nonlocal</code>重新声明该变量</li>
</ul>
<h3 id="闭包"><a class="markdownIt-Anchor" href="#闭包"></a> 闭包</h3>
<p>定义：闭包也称闭合函数。在闭合函数中，<strong>内部函数对外部作用域的变量进行引用</strong>，并且一般<strong>外部函数的返回值为内部函数</strong>，那么内部函数就被认为是闭包。</p>
<p>例如:</p>
<p>这里的<code>nth_power()</code>的返回值是<code>exponent_of</code>，并不是表达式或具体的数值。</p>
<p>并且<code>square = nth_power(2)</code>执行完后，2这个参数作为<code>exponent</code>仍然会被记住，相当于提前传入了这个参数进去。再次使用<code>aquare(2)</code>的时候，这里的2传给了内部函数定义的base，这样就可以输出结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">nth_power</span>(<span class="hljs-params">exponent</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">exponent_of</span>(<span class="hljs-params">base</span>):<br>        <span class="hljs-keyword">return</span> base ** exponent<br>    <span class="hljs-keyword">return</span> exponent_of <span class="hljs-comment"># 返回值是exponent_of函数</span><br><br>square = nth_power(<span class="hljs-number">2</span>) <span class="hljs-comment"># 计算一个数的平方</span><br>cube = nth_power(<span class="hljs-number">3</span>) <span class="hljs-comment"># 计算一个数的立方 </span><br>square<br><span class="hljs-comment"># 输出</span><br>&lt;function __main__.nth_power.&lt;<span class="hljs-built_in">locals</span>&gt;.exponent(base)&gt;<br><br>cube<br><span class="hljs-comment"># 输出</span><br>&lt;function __main__.nth_power.&lt;<span class="hljs-built_in">locals</span>&gt;.exponent(base)&gt;<br><span class="hljs-comment"># 间接调用</span><br><span class="hljs-built_in">print</span>(square(<span class="hljs-number">2</span>))  <span class="hljs-comment"># 计算2的平方</span><br><span class="hljs-built_in">print</span>(cube(<span class="hljs-number">2</span>)) <span class="hljs-comment"># 计算2的立方</span><br><br><span class="hljs-comment"># 直接调用</span><br><span class="hljs-built_in">print</span>(nth_power(<span class="hljs-number">2</span>)(<span class="hljs-number">8</span>))<br></code></pre></td></tr></table></figure>
<h3 id="匿名函数"><a class="markdownIt-Anchor" href="#匿名函数"></a> 匿名函数</h3>
<p><strong>格式</strong></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">lambda</span></span> argument1, argument2,... argumentN : expression<br></code></pre></td></tr></table></figure>
<p><strong>例子</strong></p>
<figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stan"><span class="hljs-comment"># lambda写法</span><br><span class="hljs-built_in">square</span> = lambda x: x**<span class="hljs-number">2</span><br><span class="hljs-built_in">square</span>(<span class="hljs-number">3</span>)<br><br><span class="hljs-comment"># 常规写法</span><br>def <span class="hljs-built_in">square</span>(x):<br>    <span class="hljs-keyword">return</span> x**<span class="hljs-number">2</span><br><span class="hljs-built_in">square</span>(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>
<p><strong>匿名函数与常规函数的区别</strong></p>
<ol>
<li>lambda是一个表达式，并不是语句</li>
</ol>
<ul>
<li>
<p>表达式类似于<code>x+2</code>、<code>x**2</code>等，类似公式。</p>
</li>
<li>
<p>语句是完成了一定的功能，如<code>x=1</code>完成了赋值功能，<code>print</code>语句完成了打印功能……</p>
</li>
</ul>
<p>常规函数需要通过函数名调用，且必须先定义。但作为表达式的lambda无需名字即可使用，因此lambda可以用在常规函数不能用的地方。</p>
<p>如列表内：<code>[(lambda x: x*x)(x) for x in range(10)]</code></p>
<p>如作为函数的参数：<code>ls.sort(key=lambda x: x[1])</code></p>
<ol start="2">
<li>lambda主体只有一行简单表达式，无法扩展成多行代码块</li>
</ol>
<p>Python设计之初就是为了让lambda专注于简单任务，常规函数负责复杂的多行逻辑。</p>
<p><strong>匿名函数的优点</strong></p>
<p>使用场景：你需要一个简短的函数，且只会在程序中调用一次</p>
<p>优势：简化代码复杂度，提高代码的可读性，符合Python编程习惯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 原函数：定义后调用</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">square</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x**<span class="hljs-number">2</span><br>squared = <span class="hljs-built_in">map</span>(square, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br><br><span class="hljs-comment"># lambda函数：一行搞定</span><br>squared = <span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: x**<span class="hljs-number">2</span>,[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br></code></pre></td></tr></table></figure>
<h3 id="函数式编程"><a class="markdownIt-Anchor" href="#函数式编程"></a> 函数式编程</h3>
<p>（Python支持多种编程范式：过程式、面向对象编程、函数式编程）</p>
<p>函数式编程指代码中每一块都是不可变的，由纯函数的形式组成。即函数本身互相独立，互不影响。对于相同的输入，总会有相同的输出。例如：一个列表作为参数传递至函数内，函数返回结果后原列表不会变化。</p>
<p><strong>函数式编程优缺点</strong></p>
<ul>
<li>不可变特性使得程序更加健壮、易于调试</li>
<li>限制较多，比较难写</li>
</ul>
<p><strong>例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 常规范式：</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">multiply_2</span>(<span class="hljs-params">l</span>):<br>    <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(l)):<br>        l[index] *= <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> l<br><br><span class="hljs-comment"># 函数式:重新创建新列表并返回</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">multiply_2_pure</span>(<span class="hljs-params">l</span>):<br>    new_list = []<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> l:<br>        new_list.append(item * <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> new_list<br></code></pre></td></tr></table></figure>
<p><strong>Python内置的几个相关函数</strong></p>
<p><strong>map()</strong></p>
<p>返回一个将 function 应用于 iterable 中每一项并输出其结果的迭代器。即对于每一个序列中的元素，都运行function这个函数，最后返回一个迭代器。</p>
<p>如下，对列表中每个元素乘以2操作</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ls</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br><span class="hljs-attr">new_list</span> = map(lambda x: x * <span class="hljs-number">2</span>, ls) <span class="hljs-comment"># [2， 4， 6， 8， 10]</span><br></code></pre></td></tr></table></figure>
<p>检测运行时间可得map()是最快的，由于map()由C语言写的，无需通过Python解释器间接调用，且内部做了诸多优化，因此运行最快。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ada">python3 -mtimeit -s<span class="hljs-symbol">&#x27;xs</span>=<span class="hljs-keyword">range</span>(<span class="hljs-number">1000000</span>)<span class="hljs-string">&#x27; &#x27;</span>map(lambda x: x*<span class="hljs-number">2</span>, xs)&#x27;<br><span class="hljs-number">2000000</span> loops, best <span class="hljs-keyword">of</span> <span class="hljs-number">5</span>: <span class="hljs-number">171</span> nsec per <span class="hljs-keyword">loop</span><br><br>python3 -mtimeit -s<span class="hljs-symbol">&#x27;xs</span>=<span class="hljs-keyword">range</span>(<span class="hljs-number">1000000</span>)<span class="hljs-string">&#x27; &#x27;</span>[x * <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs]&#x27;<br><span class="hljs-number">5</span> loops, best <span class="hljs-keyword">of</span> <span class="hljs-number">5</span>: <span class="hljs-number">62.9</span> msec per <span class="hljs-keyword">loop</span><br><br>python3 -mtimeit -s<span class="hljs-symbol">&#x27;xs</span>=<span class="hljs-keyword">range</span>(<span class="hljs-number">1000000</span>)<span class="hljs-string">&#x27; &#x27;</span>l = []<span class="hljs-string">&#x27; &#x27;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xs: l.append(i * <span class="hljs-number">2</span>)&#x27;<br><span class="hljs-number">5</span> loops, best <span class="hljs-keyword">of</span> <span class="hljs-number">5</span>: <span class="hljs-number">92.7</span> msec per <span class="hljs-keyword">loop</span><br></code></pre></td></tr></table></figure>
<p><strong>filter()</strong></p>
<p>用 iterable 中函数 function 返回真的那些元素，构建一个新的迭代器。即对序列中每个元素，都是用function判断，并返回True或False，最后量返回True的元素组成一个新的迭代器。</p>
<p>例如获取列表中的偶数</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">l</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br><span class="hljs-attr">new_list</span> = filter(lambda x: x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>, l) <br><span class="hljs-comment"># [2, 4]</span><br></code></pre></td></tr></table></figure>
<p><strong>reduce()</strong></p>
<p>reduce()函数在functools模块中导入。reduce()将两个参数的 function 从左至右积累地应用到 iterable 的条目，以便将该可迭代对象缩减为单一的值。即对序列中每个元素以及上一次调用后的结果，运用function进行计算，最后返回一个单独的数值。</p>
<p>例如计算某列表内所有元素的乘积，就是计算：<code>((((1*2)*3)*4)*5)</code>的值</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ls</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br><span class="hljs-attr">product</span> = reduce(lambda x, y: x * y, ls) <br><span class="hljs-comment"># 1*2*3*4*5 = 120</span><br></code></pre></td></tr></table></figure>
<p><strong>sorted()</strong></p>
<p>根据 iterable 中的项返回一个新的已排序列表。具有两个可选参数，它们都必须指定为关键字参数。</p>
<p><strong>key</strong> 指定带有单个参数的函数，用于从 iterable 的每个元素中提取用于比较的键 (例如 key=str.lower)。 默认值为 None (直接比较元素)。<strong>reverse</strong> 为一个布尔值。 如果设为 True，则每个列表元素将按反向顺序比较进行排序。</p>
<p>key形参的值一般是一个函数或其他可调用对象，在进行比较前，每个列表元素调用该函数(或可调用对象)。如下，按照字典的value值进行排序。d.items()拿到的是键值对，lambda匿名函数返回键值对的value值，sorted按照value 值进行排序。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">sorted</span><span class="hljs-params">(d.items()</span></span>, key=lambda x: x<span class="hljs-selector-attr">[1]</span>)<br></code></pre></td></tr></table></figure>
<p>默认情况下，对字符串排序时是按照ASCII的大小比较的。</p>
<ul>
<li>
<p>list.sort()：直接原地排序列表，只接受列表排序</p>
</li>
<li>
<p>sorted()：构建新的排序列表，不对源列表修改，接受所有可迭代对象</p>
</li>
</ul>
<h3 id="计时函数"><a class="markdownIt-Anchor" href="#计时函数"></a> 计时函数</h3>
<p>timeit模块是内置用于统计小段代码执行时间的模块，该库默认将语句执行一百万次，并从提供从集合中花费的最短时间。</p>
<p>官网地址：<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.8/library/timeit.html">https://docs.python.org/zh-cn/3.8/library/timeit.html</a></p>
<p><strong>语法</strong></p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-comment"># stmt：需要测试的代码（表达式/变量/函数），必填，默认pass</span><br><span class="hljs-comment"># setup: 所执行代码的运行环境，必填，默认pass</span><br><span class="hljs-comment"># timer:当前系统时间单位，默认即可</span><br><span class="hljs-comment"># number:要测试的代码运行测试，默认100万次</span><br>timeit.timeit(stmt, setup,timer, <span class="hljs-built_in">number</span>)<br></code></pre></td></tr></table></figure>
<p><strong>调用方式</strong></p>
<ol>
<li>命令行调用</li>
</ol>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs maxima">python3 -m timeit &#x27;<span class="hljs-string">&quot;-&quot;</span>.<span class="hljs-built_in">join</span>(str(n) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>))&#x27;<br><br># 调用多行<br>python3 -m timeit -s&#x27;xs=<span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>)&#x27; &#x27;<span class="hljs-built_in">map</span>(<span class="hljs-built_in">lambda</span> x: x*<span class="hljs-number">2</span>, xs)&#x27;<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>函数接口调用</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> timeit<br><span class="hljs-meta">&gt;&gt;&gt; </span>timeit.timeit(<span class="hljs-string">&#x27;&quot;-&quot;.join(str(n) for n in range(100))&#x27;</span>, number=<span class="hljs-number">10000</span>)<br><br><span class="hljs-comment"># 或者</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>timeit.timeit(<span class="hljs-keyword">lambda</span>: <span class="hljs-string">&quot;-&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>))), number=<span class="hljs-number">10000</span>)<br></code></pre></td></tr></table></figure>
<h2 id="面向对象"><a class="markdownIt-Anchor" href="#面向对象"></a> 面向对象</h2>
<h3 id="面向对象编程四要素"><a class="markdownIt-Anchor" href="#面向对象编程四要素"></a> 面向对象编程四要素</h3>
<p>类：对应class，是一群有着相同属性和函数的对象的集合。</p>
<p>对象：class实例化生成的东西</p>
<p>属性：对象的静态特征，如一个人的身高、年龄</p>
<p>函数：对象的某个动态能力</p>
<p>类，属性，函数，对象的关系可以总结为：<strong>类是一群具有相同属性和函数的对象的集合</strong>。</p>
<p>面向对象的一大优势就是将算法的复杂性隔离开，保留街口和其他代码不变。在公司团队协作中，设计好合理分层后，每层的逻辑只需要处理好分内的事即可。</p>
<p><strong>类常量</strong></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment">#方式一</span><br>p = Pepole()<br>p.WELCOME_STR<br><span class="hljs-comment"># 方式二</span><br>Pepole.WELCOME_STR<br></code></pre></td></tr></table></figure>
<h3 id="类的三种函数"><a class="markdownIt-Anchor" href="#类的三种函数"></a> 类的三种函数</h3>
<p><strong>类函数</strong></p>
<p>在函数上方添加<code>@classmethod</code>装饰器。类函数第一个参数一般是cls，表示必须传一个类进来。</p>
<p>最常用的功能是实现不同的init构造函数。</p>
<p><strong>成员函数</strong></p>
<p>最常用的函数，无需任何装饰器生命，第一个参数为self，代表当前对象的引用。</p>
<p>常用古语查询、修改类的属性等</p>
<p>静态函数</p>
<p>在函数上方添加<code>@staticmethod</code>装饰器</p>
<p>用于做一些简单独立的任务，便于测试、优化代码结构。</p>
<h3 id="继承"><a class="markdownIt-Anchor" href="#继承"></a> 继承</h3>
<p>面向对象学过的话这个应该很简单就能理解。子类拥有父类的特征（函数、属性），也可以拥有自己不同的特征。大概包括以下三个内容：</p>
<ul>
<li>继承：继承父类属性&amp;函数。</li>
<li>重写：子类重写父类函数，补充细节代码。</li>
<li>新特征：子类可以定义新函数、属性。</li>
</ul>
<p><strong>构造函数</strong></p>
<p>子类生成对象时，不会自动调用父类的构造函数。如果想在子类调用父类的构造函数，必须使用super关键字或类名显式地调用。</p>
<ul>
<li>子类需要自动调用父类构造：子类不重写<code>__init__()</code>函数，隐式调用父类构造
<ul>
<li>这种情况下，子类调用继承的函数时，是通过父类对象调用的，并非通过子类本身调用</li>
</ul>
</li>
<li>子类不需要自动调用父类构造：子类重写<code>__init__()</code>函数
<ul>
<li>这种情况下，子类只继承父类的成员函数，不继承构造函数中的私有属性</li>
</ul>
</li>
<li>子类既需重写<code>__init__()</code>又需调用父类构造：在子类构造函数中使用<code>super()</code>显式调用父类构造
<ul>
<li>？？？关于子类调用父类成员函数时到底是通过哪个对象调用的，做个试验观察一下</li>
</ul>
</li>
</ul>
<p>如下案例：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Document</span>(Entity):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, object_type</span>):<br>        print(<span class="hljs-string">&#x27;document class init called&#x27;</span>)<br>        <span class="hljs-comment"># 使用父类类名显示调用父类构造函数</span><br>        Entity.__init__(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&#x27;document&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.object_type = object_type<br>    <br>    <span class="hljs-comment"># 防止直接通过当前类生成对象调用该函数，让子类重写一遍，覆盖掉继承的函数</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_context_length</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):<br>        raise Exception(<span class="hljs-string">&#x27;get_context_length not implemented&#x27;</span>)<br>    <br>    <span class="hljs-comment"># 子类无需定义或重写该函数就可使用，继承的优点在于减少重复代码</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">print_title</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):<br>        print(<span class="hljs-variable language_">self</span>.title)<br></code></pre></td></tr></table></figure>
<p><strong>访问父类变量的方式</strong></p>
<ol>
<li>调用父类中可以访问到本身私有变量的函数</li>
<li>不推荐的写法，强行访问：<code>self._ParentClass__var</code></li>
</ol>
<p><strong>多继承</strong></p>
<p>多继承又分为两种：一个类同时继承多个类或者一个类单一继承多个类（广度与深度）</p>
<p>单一继承时，构造执行顺序为子类-&gt; 父类 -&gt; 爷类 -&gt;… 的链式关系</p>
<p>多重继承(例如菱形继承)时：基于某算法进行查找，可自己查询：<code>className.__mro__</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>bc.Document.__mro__  <br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;bc.Document&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;bc.Entity&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;)<br></code></pre></td></tr></table></figure>
<p><strong>多重继承的构造方法</strong></p>
<p>如下，这是一个搜索引擎缓存类，继承了搜索引擎类和缓存模块，这里有一些复杂而又经典的调用</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BOWInvertedIndexEngineWithCache</span>(BOWInvertedIndexEngine, LRUCache):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):<br>        <span class="hljs-comment"># 这里的super()指向的是最左侧的父类，类名填的是当前类类名</span><br>        <span class="hljs-variable language_">super</span>(BOWInvertedIndexEngineWithCache, <span class="hljs-variable language_">self</span>).__init__()<br>        <span class="hljs-comment"># 需要调用哪个父类构造器，就直接使用父类名来调用</span><br>        LRUCache.__init__(<span class="hljs-variable language_">self</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, query</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.has(query):<br>            print(<span class="hljs-string">&#x27;cache hit!&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.get(query)<br>            <br>        <span class="hljs-comment"># 在重写后的search中强行调用已被覆盖的父类search函数（因为当前层是辅助作用，功能实现还是在父类）</span><br>        result = <span class="hljs-variable language_">super</span>(BOWInvertedIndexEngineWithCache, <span class="hljs-variable language_">self</span>).search(query)<br>        <span class="hljs-variable language_">self</span>.set(query, result)<br><br>        <span class="hljs-keyword">return</span> result<br></code></pre></td></tr></table></figure>
<p>多重构造下有两种方式初始化父类</p>
<ol>
<li>初始化该类的第一个父类（python2写法）：<code>super(BOWInvertedIndexEngineWithCache, self).__init__()</code></li>
<li>传统方式（python3写法）：<code> LRUCache.__init__(self)</code></li>
</ol>
<p>补充知识：</p>
<p>检索算法：<a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95">倒排索引</a></p>
<h3 id="抽象类-抽象函数"><a class="markdownIt-Anchor" href="#抽象类-抽象函数"></a> 抽象类、抽象函数</h3>
<p>一般来说，如果真的需要<code>Entity</code>类不让外界实例化，那就直接把<code>Entity</code>做成抽象类。抽象类使用<code>abstractmethod</code>	装饰器来表示，抽象类只能作为父类存在，无法实例化，抽象类中的函数就是抽象函数。子类继承抽象类，必须重写所有抽象函数。</p>
<p>Java中也有抽象类的语法。抽象类是自上而下的设计风格，类似于接口，用简单的代码定义好规则，然后交给不同的开发人员去开发和对接。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs scala">from abc <span class="hljs-keyword">import</span> <span class="hljs-type">ABCMeta</span>, abstractmethod<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entity</span>(<span class="hljs-params">metaclass=<span class="hljs-type">ABCMeta</span></span>)</span>:<br>    <span class="hljs-meta">@abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_title</span></span>(self):<br>        pass<br>        <br>    <span class="hljs-meta">@abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_title</span></span>(self, title):<br>        pass<br><br>&gt;&gt;&gt; ee=bc.<span class="hljs-type">Entity</span>()<br><span class="hljs-type">Traceback</span> (most recent call last):<br>  <span class="hljs-type">File</span> <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="hljs-number">1</span>, in &lt;module&gt;<br><span class="hljs-type">TypeError</span>: <span class="hljs-type">Can</span>&#x27;t instantiate <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entity</span> <span class="hljs-keyword">with</span> <span class="hljs-title">abstract</span> <span class="hljs-title">methods</span> <span class="hljs-title">get_title</span>, <span class="hljs-title">set_title</span></span><br>&gt;&gt;&gt;<br></code></pre></td></tr></table></figure>
<h2 id="模块管理"><a class="markdownIt-Anchor" href="#模块管理"></a> 模块管理</h2>
<h3 id="简单模块引用"><a class="markdownIt-Anchor" href="#简单模块引用"></a> 简单模块引用</h3>
<p>在导包时，需要在模块所在的文件夹新建一个<code> __init__.py</code>，内容可以为空，也可以用来表述包对外暴露的模块接口。不过事实上这是 Python 2 的规范。在 Python 3 规范中，<code>__init__.py</code> 并不是必须的，</p>
<p>在导包时应注意代码的顺序。代码是由上至下逐行运行的。编辑器在保存时有可能会重新对导包进行排序，从而导致包导入失败。</p>
<p><strong>同路径引用</strong></p>
<figure class="highlight capnproto"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs capnproto">.<br>├── utils<br>├── class_utils<br>└── main.py<br><br><span class="hljs-comment"># 导入utils中的get_sum函数</span><br><span class="hljs-keyword">from</span> utils <span class="hljs-keyword">import</span> get_sum<br><br><span class="hljs-comment"># 导入class_utils 中所有函数</span><br><span class="hljs-keyword">from</span> class_utils <span class="hljs-keyword">import</span> *<br></code></pre></td></tr></table></figure>
<p><strong>不同路径引用</strong></p>
<p>注意，类似PyChrome编辑器会将<code>sys.path[0]</code>也就是路径列表的第一项设置为项目根目录的绝对地址，所以<code>sys.path.append(&quot;..&quot;)</code>是可以正常导入的。但我这里的<code>sys.path[0]</code>是当前模块所在目录，所以无法导入。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs clean">.<br>├── utils<br>│   └── class_utils.py<br>├── src<br>│   └── sub<br>│   	└── sub_ff.py<br>│   └── sub_main.py<br><br># 在 sub_main 中导入 class_utils 模块，需要在路径目录中添加class_utils所在目录<br># 有绝对路径、相对路径两种写法（一般是用两个点表示上级，但我实测没什么用，用其他方式可以）<br><span class="hljs-keyword">import</span> sys<br># 一般写法<br>sys.path.append(<span class="hljs-string">&quot;..&quot;</span>)<br># 我的写法①：相对路径<br>sys.path.append(sys.path[<span class="hljs-number">0</span>]+<span class="hljs-string">&#x27;\\..&#x27;</span>)<br># 我的写法②：绝对路径(mode为src的上层目录)<br>sys.path.append(<span class="hljs-string">&#x27;d:\\xxx\\xxx\\xxx\\modo&#x27;</span>)<br><br><br><span class="hljs-keyword">from</span> utils.class_utils <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sub.sub_ff <span class="hljs-keyword">import</span> *<br></code></pre></td></tr></table></figure>
<h3 id="项目模块化"><a class="markdownIt-Anchor" href="#项目模块化"></a> 项目模块化</h3>
<p>在大型工程中尽可能使用绝对位置。对于独立项目来说，所有模块的追寻方式最好从项目的根目录开始追溯，这叫相对的绝对路径。</p>
<p>上面我已经写了如何导入上一层目录下的模块/指定目录模块，其实质就是将当前路径目录中的路径修改成想要的路径，或者直接在列表中添加新的绝对路径。但这并不是最佳方案，是不推荐的写法。最佳写法应该是为该项目设置虚拟环境，并讲根目录以环境变量的方式添加进去。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 创建虚拟环境</span><br>python -m venv <span class="hljs-regexp">/path/</span>to<span class="hljs-regexp">/new/</span>virtual/environment  <span class="hljs-comment"># linux</span><br>python -m venv c:\path\to\myenv  <span class="hljs-comment"># windows</span><br><br><span class="hljs-comment"># 激活虚拟环境</span><br>source &lt;venv&gt;<span class="hljs-regexp">/bin/</span>activate  <span class="hljs-comment"># linux</span><br>C:\&gt; &lt;venv&gt;\Scripts\activate.bat  <span class="hljs-comment"># windows</span><br><br><span class="hljs-comment"># 退出虚拟环境</span><br>deactivate<br><br><span class="hljs-comment"># 删除虚拟环境</span><br>删除虚拟环境所在目录即可<br></code></pre></td></tr></table></figure>
<p><strong>注意用法</strong>：<strong><code>if __name__=='__main__'</code></strong></p>
<p><code>__name__</code>属性是Python的一个内置属性，记录了一个字符串</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># utils.py 在本文件中调用时，显示<span class="hljs-strong">__main__</span></span><br>print(<span class="hljs-strong">__name__</span>)<br><span class="hljs-section"># out: <span class="hljs-strong">__main__</span></span><br><br><span class="hljs-section"># main.py 在其他文件中调用utils.<span class="hljs-strong">__name__</span>时，显示的是utils模块名称</span><br>import utils<br>print(utils.<span class="hljs-strong">__name__</span>)<br><span class="hljs-section"># out: utils</span><br></code></pre></td></tr></table></figure>
<p>这个判断表示当<code>__name__</code>的值为<code>__main__</code>时，才能执行块中的代码，如果不是则不执行。</p>
<p>Python的<code>import</code>导入其他模块时会自动将暴露在外面的代码全部执行一遍。因此如果需要把某个文件封装成模块以供其他模块调用，就必须将要执行的代码放在<code>if __name__=='__main__':</code>块下面。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># utils_with_main.py</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sum</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> a + b<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;testing&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125; + &#123;&#125; = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, get_sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure>
<p>总结来说就是</p>
<ul>
<li>import文件内的<code>if __name__=='__main__':</code>不会执行</li>
<li>主程序内的代码<code>if __name__=='__main__':</code>会执行</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Study/" class="category-chain-item">Study</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python/">#Python</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Python3.8进阶(一)</div>
      <div>https://zhouyinglin.cn/post/pythonjinjie1.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>小周</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年11月21日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2022年12月15日</div>
        </div>
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                <i class="iconfont icon-sa"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/post/7456a33d.html" title="视频弹幕词云图生成器">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">视频弹幕词云图生成器</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/post/renaissance.html" title="文艺复兴文学——从神到人">
                        <span class="hidden-mobile">文艺复兴文学——从神到人</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.5.1/waline.min.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.5.1/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://waline-comment-blond.vercel.app/","path":"window.location.pathname","meta":["nick","mail","link"],"login":"enable","lang":"zh-CN","emoji":["https://unpkg.com/@waline/emojis@1.0.1/tieba","https://unpkg.com/@waline/emojis@1.0.1/bilibili"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
     
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <div id="waline"></div> <script> const locale = { placeholder: "说点什么吧！(填写邮箱可在被回复时收到邮件提醒)", }; Waline.init({ el: "#waline", serverURL: "https://comment.zhouyinglin.cn/", locale, }); </script>
        </div>
      </div>
    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <link rel="stylesheet" href="/dist/APlayer.min.css"> <div id="aplayer"></div> <script type="text/javascript" src="/dist/APlayer.min.js"></script> <script type="text/javascript" src="/js/amusic.js"></script>  <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div class="statistics" style="font-size: 0.85rem"> <a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #3c4858;"  id="hitokoto"></span></a> <script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script></div>  <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访客量 
        <span id="leancloud-site-pv"></span>
         次 
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总用户量 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>
<div class="statistics">
 	<a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #DDD;"  id="hitokoto"></span></a>
<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
 </div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
